<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <meta name="description" content="MathJax.Hub.Config({tex2jax: {inlineMath: [[&#39;$&#39;,&#39;$&#39;], [&#39;\\(&#39;,&#39;\\)&#39;]]}});" />
  

  
  
  
  
  
  
  <title>haskell实战和例子 | 烂笔头</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="MathJax.Hub.Config({tex2jax: {inlineMath: [[&#39;$&#39;,&#39;$&#39;], [&#39;\\(&#39;,&#39;\\)&#39;]]}});">
<meta property="og:type" content="article">
<meta property="og:title" content="haskell实战和例子">
<meta property="og:url" content="http://yoursite.com/2020/07/15/haskell%E5%AE%9E%E6%88%98%E5%92%8C%E4%BE%8B%E5%AD%90/index.html">
<meta property="og:site_name" content="烂笔头">
<meta property="og:description" content="MathJax.Hub.Config({tex2jax: {inlineMath: [[&#39;$&#39;,&#39;$&#39;], [&#39;\\(&#39;,&#39;\\)&#39;]]}});">
<meta property="og:locale">
<meta property="article:published_time" content="2020-07-15T00:37:24.000Z">
<meta property="article:modified_time" content="2021-11-17T02:41:37.370Z">
<meta property="article:author" content="李博">
<meta property="article:tag" content="数学">
<meta name="twitter:card" content="summary">
  
  
    <link rel="icon" href="/css/images/favicon.ico">
  
  
<link rel="stylesheet" href="/css/style.css">

  

  
  <!-- baidu webmaster push -->
  <script src='//push.zhanzhang.baidu.com/push.js'></script>
<meta name="generator" content="Hexo 5.4.0"></head>
<body class="home blog custom-background custom-font-enabled single-author">
  <div id="page" class="hfeed site">
      <header id="masthead" class="site-header" role="banner">
    <hgroup>
      <h1 class="site-title">
        <a href="/" title="烂笔头" rel="home">烂笔头</a>
      </h1>
      
        <h2 class="site-description hitokoto"></h2>
        <script type="text/javascript" src="https://v1.hitokoto.cn/?encode=js"></script>
      
    </hgroup>

    <nav id="site-navigation" class="main-navigation" role="navigation">
            <button class="menu-toggle">菜单</button>
            <a class="assistive-text" href="/#content" title="跳至内容">跳至内容</a><!--TODO-->
            <div class="menu-main-container">
                <ul id="menu-main" class="nav-menu">
                
                    <li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="/">Home</a></li>
                
                    <li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="/archives">Archives</a></li>
                
                    <li class="menu-item menu-item-type-post_type menu-item-object-page"><a target="_blank" rel="noopener" href="https://github.com/wujilingfeng/">Github</a></li>
                
                    <li class="menu-item menu-item-type-post_type menu-item-object-page"><a target="_blank" rel="noopener" href="https://gitee.com/">Gitee</a></li>
                
                </ul>
            </div>
    </nav>
</header>

      <div id="main" class="wrapper">
        <div id="primary" class="site-content"><div id="content" role="main"><article id="post-haskell实战和例子" class="post-haskell实战和例子 post type-post status-publish format-standard hentry">
    <!---->

      <header class="entry-header">
        
        
  
    <h1 class="entry-title article-title">
      haskell实战和例子
    </h1>
  

        
        <div class="comments-link">
            
            <a href="/2020/07/15/haskell%E5%AE%9E%E6%88%98%E5%92%8C%E4%BE%8B%E5%AD%90/#comments" class="leave-reply">Reply</a>
            
            <a href="javascript:void(0);" data-url="http://yoursite.com/2020/07/15/haskell%E5%AE%9E%E6%88%98%E5%92%8C%E4%BE%8B%E5%AD%90/" data-id="ckwh75u8j002p9wxjaghj9y8j" class="leave-reply bdsharebuttonbox" data-cmd="more">Share</a>
        </div><!-- .comments-link -->
      </header><!-- .entry-header -->

    <div class="entry-content">
      
        <script type="text/x-mathjax-config">
  MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
</script>
<script type="text/javascript" async
  src="https://wujilingfeng.top/MathJax/MathJax.js?config=TeX-AMS_CHTML">
</script>




<span id="more"></span>

<p>[toc]</p>
<h4 id="ghci"><a href="#ghci" class="headerlink" title="ghci"></a>ghci</h4><p>如果想要在ghci加载重命名的模块，只需要像在文件那样</p>
<figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Data.ByteString <span class="keyword">as</span> BB</span><br></pre></td></tr></table></figure>

<p>ghci也支持多行输入模式，在ghci中输入:set +m就可以了。也可以用:{    ……       :}括住</p>
<p>输入<code>:set -package matrix</code> 使得matrix包可见，然后<code>:m Data.Matrix</code>就可以使用matrix模块了。 </p>
<p><a target="_blank" rel="noopener" href="https://cabal.readthedocs.io/en/3.4/cabal-package.html?highlight=foreign#foreign-libraries">把haskell编译成动态库</a></p>
<p><a target="_blank" rel="noopener" href="http://www.voidcn.com/article/p-zoszxlmy-bsw.html">寻找不同模块的文件</a></p>
<figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="title">ghci</span> <span class="type">Bar</span>.hs -i.:config</span><br><span class="line"><span class="comment">--在 ./和./config寻找依赖</span></span><br><span class="line">:t <span class="comment">--查看算子类型映射</span></span><br><span class="line">:k <span class="comment">--查看函子类型的映射</span></span><br><span class="line">:i</span><br></pre></td></tr></table></figure>


<h4 id="cabal"><a href="#cabal" class="headerlink" title="cabal"></a>cabal</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">cabal run :mesh</span><br><span class="line">cabal configure</span><br><span class="line">cabal build</span><br><span class="line">cabal install</span><br><span class="line">cabal v2-install Cabal cabal-install <span class="comment">###更新 cabal cabal-install</span></span><br><span class="line">ghc-pkg unregister<span class="comment">##取消注册包</span></span><br></pre></td></tr></table></figure>



<figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="title">diff</span> :: (<span class="type">Float</span>-&gt;<span class="type">Float</span>)-&gt;(<span class="type">Float</span>-&gt;<span class="type">Float</span>)</span><br><span class="line"><span class="title">diff</span> f=f&#x27;</span><br><span class="line">	<span class="keyword">where</span> f&#x27; x=(f (f+h)- f x)/h</span><br><span class="line">		h=<span class="number">0.0001</span></span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://cabal.readthedocs.io/en/latest/developing-packages.html">cabal</a></p>
<p>.cabal的的build-depends选项的内容是package的名字，不是modules的名字。</p>
<p>cabal发布包:<code>cabal sdist</code></p>
<p><a target="_blank" rel="noopener" href="https://www.haskell.org/haddock/doc/html/ch03s08.html">haddock语法</a></p>
<p>haddock 会忽略haskell代码中的注释，如果想要显示注释需要加<code>|</code>。如果想要显示代码块可以用<code>@</code>包裹，或者每行加<code>&gt;</code>。如果想要展示脚本运行的代码和结果</p>
<figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- &gt;&gt;&gt; putStrLn &quot;hell&quot;</span></span><br><span class="line"><span class="comment">-- hell</span></span><br></pre></td></tr></table></figure>



<p>单引号用来引用非模块的元素如fucntion ,type, class, constructor,双引号引用模块元素。</p>
<p> <a target="_blank" rel="noopener" href="https://svejcar.dev/posts/2020/02/29/uploading-package-to-hackage/">创建包</a></p>
<p><a target="_blank" rel="noopener" href="https://downloads.haskell.org/~ghc/7.0.3/docs/html/Cabal/authors.html">资料</a></p>
<p>如果等式的左右两端含有相同算子，那么haskell会采用纽结的技巧进行链接:</p>
<figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">data</span> <span class="type">DList</span> a = <span class="type">DLNode</span> (<span class="type">DList</span> <span class="title">a</span>) a (<span class="type">DList</span> <span class="title">a</span>)</span></span><br><span class="line"></span><br><span class="line"><span class="title">mkDList</span> :: [a] -&gt; <span class="type">DList</span> a</span><br><span class="line"></span><br><span class="line"><span class="title">mkDList</span> [] = error <span class="string">&quot;must have at least one element&quot;</span></span><br><span class="line"><span class="title">mkDList</span> xs = <span class="keyword">let</span> (first,last) = go last xs first</span><br><span class="line">             <span class="keyword">in</span>  first</span><br><span class="line"></span><br><span class="line">  <span class="keyword">where</span> go :: <span class="type">DList</span> a -&gt; [a] -&gt; <span class="type">DList</span> a -&gt; (<span class="type">DList</span> a, <span class="type">DList</span> a)</span><br><span class="line">        go prev []     next = (next,prev)</span><br><span class="line">        go prev (x:xs) next = <span class="keyword">let</span> this        = <span class="type">DLNode</span> prev x rest</span><br><span class="line">                                  (rest,last) = go this xs next</span><br><span class="line">                              <span class="keyword">in</span>  (this,last)</span><br><span class="line"></span><br><span class="line"><span class="title">takeF</span> :: <span class="type">Integer</span> -&gt; <span class="type">DList</span> a -&gt; [a]</span><br><span class="line"><span class="title">takeF</span> <span class="number">0</span>     _                 = []</span><br><span class="line"><span class="title">takeF</span> n (<span class="type">DLNode</span> _ x next)     = x : (takeF (n<span class="number">-1</span>) next)</span><br><span class="line"></span><br><span class="line"><span class="title">takeR</span> :: <span class="type">Show</span> a =&gt; <span class="type">Integer</span> -&gt; <span class="type">DList</span> a -&gt; [a]</span><br><span class="line"><span class="title">takeR</span> <span class="number">0</span>     _                 = []</span><br><span class="line"><span class="title">takeR</span> n (<span class="type">DLNode</span> prev x _)     = x : (takeR (n<span class="number">-1</span>) prev)</span><br></pre></td></tr></table></figure>

<p>这些例子可以<a target="_blank" rel="noopener" href="https://wiki.haskell.org/Tying_the_Knot#Migrated_from_the_old_wiki">参考</a>, </p>
<h4 id="list"><a href="#list" class="headerlink" title="list"></a>list</h4><p>精通haskell重要指标是精通list,尤其是list comprehension</p>
<table>
<thead>
<tr>
<th>算子</th>
<th>意义</th>
</tr>
</thead>
<tbody><tr>
<td>++</td>
<td></td>
</tr>
<tr>
<td>:</td>
<td></td>
</tr>
<tr>
<td>!!</td>
<td>[a]-&gt;Int-&gt;a</td>
</tr>
<tr>
<td>elem</td>
<td>(Foldable t,Eq a)=&gt; a-&gt;t a-&gt;Bool</td>
</tr>
<tr>
<td>zipWith</td>
<td>(a-&gt;b-&gt;c)-&gt;[a]-&gt;[b]-&gt;[c],它可以用来实现链表的内积</td>
</tr>
<tr>
<td>init</td>
<td>除去最后一个元素的数列</td>
</tr>
<tr>
<td>head</td>
<td>数列第一个元素</td>
</tr>
<tr>
<td>last</td>
<td>最后一个元素</td>
</tr>
<tr>
<td>drop</td>
<td>除去前n个元素</td>
</tr>
<tr>
<td>take</td>
<td>取数列前n个元素</td>
</tr>
<tr>
<td>reverse</td>
<td>反转列表</td>
</tr>
<tr>
<td>sum</td>
<td>对列表求和</td>
</tr>
<tr>
<td>product</td>
<td>对列表连乘</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
</tbody></table>
<h4 id="list-comprehension"><a href="#list-comprehension" class="headerlink" title="list comprehension"></a>list comprehension</h4><figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[(i,j) | i &lt;- [<span class="number">1</span>,<span class="number">2</span>],</span><br><span class="line">         j &lt;- [<span class="number">1.</span><span class="number">.4</span>] ]</span><br></pre></td></tr></table></figure>

<p>list comprehensio对于复杂表达式要注意加括号</p>
<figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="title">list_c</span>::[<span class="type">String</span>]-&gt;[<span class="type">Int</span>]</span><br><span class="line"><span class="title">list_c</span> s=[i|i&lt;-[<span class="number">0.</span>.(length s - <span class="number">1</span> )],(elem (s!! i) [<span class="string">&quot;SIZE&quot;</span>])]</span><br></pre></td></tr></table></figure>

<p>haskell Arrays可以代替list</p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/zwvista/archive/2004/01/13/7591421.html">haskell arrays</a></p>
<h4 id="逻辑运算"><a href="#逻辑运算" class="headerlink" title="逻辑运算"></a>逻辑运算</h4><table>
<thead>
<tr>
<th>逻辑运算符</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td>not</td>
<td></td>
</tr>
<tr>
<td>||</td>
<td></td>
</tr>
<tr>
<td>&amp;&amp;</td>
<td></td>
</tr>
<tr>
<td>/=</td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
</tbody></table>
<h4 id="随机数"><a href="#随机数" class="headerlink" title="随机数"></a>随机数</h4><figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="title">take</span> <span class="number">10</span> $ randomRs (&#x27;a&#x27;,&#x27;z&#x27;) (mkStdGen <span class="number">3</span>) :: [<span class="type">Char</span>]</span><br><span class="line"><span class="title">take</span> <span class="number">10</span> $ randomRs (<span class="number">1</span>,<span class="number">1000</span>) (mkStdGen <span class="number">3</span>) :: [<span class="type">Int</span>]</span><br></pre></td></tr></table></figure>

<h4 id="Matrix"><a href="#Matrix" class="headerlink" title="Matrix"></a>Matrix</h4><table>
<thead>
<tr>
<th>函数</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td>setElem</td>
<td></td>
</tr>
<tr>
<td>getElem</td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
</tbody></table>
<h4 id="ghc-flags"><a href="#ghc-flags" class="headerlink" title="ghc flags"></a>ghc flags</h4><p><a target="_blank" rel="noopener" href="https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/flags.html">这里</a></p>
<table>
<thead>
<tr>
<th>flags</th>
<th>意义</th>
</tr>
</thead>
<tbody><tr>
<td>-c</td>
<td>生成.o文件</td>
</tr>
<tr>
<td>-no-hs-main</td>
<td>源文件.hs没有main函数</td>
</tr>
<tr>
<td>-o</td>
<td>输出结果</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
</tbody></table>
<h4 id="keywords"><a href="#keywords" class="headerlink" title="keywords"></a>keywords</h4><p><a target="_blank" rel="noopener" href="https://wiki.haskell.org/Keywords">这里</a></p>
<h4 id="pragmas"><a href="#pragmas" class="headerlink" title="pragmas"></a>pragmas</h4><p><a target="_blank" rel="noopener" href="https://downloads.haskell.org/~ghc/7.0.3/docs/html/users_guide/pragmas.html">这里</a></p>
<p><a target="_blank" rel="noopener" href="https://xiaochai.github.io/2019/10/11/haskell/">haskell入门笔记</a></p>
<h4 id="Monad"><a href="#Monad" class="headerlink" title="Monad"></a>Monad</h4><table>
<thead>
<tr>
<th>算子</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td>&lt;=&lt;</td>
<td></td>
</tr>
<tr>
<td>=&lt;&lt;</td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
</tbody></table>
<h5 id="记录语法"><a href="#记录语法" class="headerlink" title="记录语法"></a>记录语法</h5><figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">data</span> <span class="type">Person</span> = <span class="type">Person</span> &#123; <span class="title">firstName</span> :: <span class="type">String</span>  </span></span><br><span class="line"><span class="class">                     , <span class="title">lastName</span> :: <span class="type">String</span>  </span></span><br><span class="line"><span class="class">                     , <span class="title">age</span> :: <span class="type">Int</span>  </span></span><br><span class="line"><span class="class">                     , <span class="title">height</span> :: <span class="type">Float</span>  </span></span><br><span class="line"><span class="class">                     , <span class="title">phoneNumber</span> :: <span class="type">String</span>  </span></span><br><span class="line"><span class="class">                     , <span class="title">flavor</span> :: <span class="type">String</span>  </span></span><br><span class="line"><span class="class">                     &#125; | <span class="type">Noper</span> </span></span><br><span class="line">                     <span class="keyword">deriving</span> (<span class="type">Show</span>)</span><br><span class="line"><span class="comment">--注意firsName等都是首字母小写，否则会出错</span></span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/zwvista/p/7679450.html">Data.Map</a></p>
<table>
<thead>
<tr>
<th>常用Map算子</th>
<th>意义</th>
</tr>
</thead>
<tbody><tr>
<td>member Map a b</td>
<td></td>
</tr>
<tr>
<td>size Map a b</td>
<td></td>
</tr>
<tr>
<td>!</td>
<td></td>
</tr>
<tr>
<td>lookup</td>
<td></td>
</tr>
<tr>
<td>delete k Map k b</td>
<td></td>
</tr>
<tr>
<td>insert k v Map k v</td>
<td></td>
</tr>
<tr>
<td>traverseWithKey</td>
<td>可以对比mapM</td>
</tr>
</tbody></table>
<h4 id="IO"><a href="#IO" class="headerlink" title="IO"></a>IO</h4><p><a target="_blank" rel="noopener" href="http://learnyouahaskell.com/input-and-output">IO</a><br><a target="_blank" rel="noopener" href="https://www.cnblogs.com/livewithnorest/archive/2012/08/02/2620718.html">这里</a></p>
<table>
<thead>
<tr>
<th>算子</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td>openFile</td>
<td>openFile “t.txt” ReadMode || openFile “t.txt” WriteMode || openFile “t.txt” ReadWriteMode</td>
</tr>
<tr>
<td>openBinaryFile</td>
<td>同上</td>
</tr>
<tr>
<td>read</td>
<td>和show互为逆算子,Read a=&gt; String -&gt; a</td>
</tr>
<tr>
<td>show</td>
<td>和read互为逆算子Show a=&gt; a-&gt;String</td>
</tr>
<tr>
<td>mapM</td>
<td>是map函数在副作用上的移植</td>
</tr>
<tr>
<td>toChunks</td>
<td>strict ByteString 转化为lazy ByteString</td>
</tr>
<tr>
<td>fromChunks</td>
<td>lazyByteString 转化为strict ByteString</td>
</tr>
<tr>
<td>Data.Binary.ByteString.head</td>
<td>类似list的head函数，返回头一个元素</td>
</tr>
<tr>
<td>Data.Binary.ByteString.tail</td>
<td>类似list的tail函数，返回除第一个以外的元素</td>
</tr>
<tr>
<td>hIsEOF</td>
<td>是否到文件末尾</td>
</tr>
<tr>
<td>putChar</td>
<td>打印字符</td>
</tr>
<tr>
<td>putStr</td>
<td>打印字符串</td>
</tr>
<tr>
<td>getChar</td>
<td>读取一个字符</td>
</tr>
<tr>
<td>getLine</td>
<td>读取一行字符串</td>
</tr>
<tr>
<td>=&lt;&lt;</td>
<td></td>
</tr>
<tr>
<td>return</td>
<td>注意return的声明是Monad m=&gt;a-&gt;m a</td>
</tr>
<tr>
<td>hPutStr</td>
<td></td>
</tr>
<tr>
<td>hClose</td>
<td>使用完openFile后关闭</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
</tbody></table>
<figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="title">main</span> = <span class="keyword">do</span>   </span><br><span class="line">   <span class="keyword">let</span> var = <span class="number">26</span> </span><br><span class="line"></span><br><span class="line">   <span class="keyword">if</span> var == <span class="number">0</span> </span><br><span class="line">      <span class="keyword">then</span> putStrLn <span class="string">&quot;hei&quot;</span> </span><br><span class="line">   <span class="keyword">else</span> <span class="keyword">if</span> var `rem` <span class="number">2</span> == <span class="number">0</span> </span><br><span class="line">      <span class="keyword">then</span> putStrLn <span class="string">&quot;Number is Even&quot;</span> </span><br><span class="line">   <span class="keyword">else</span> putStrLn <span class="string">&quot;Number is Odd&quot;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="title">main</span> = <span class="keyword">do</span>   </span><br><span class="line">    line &lt;- getLine  </span><br><span class="line">    <span class="keyword">if</span> null line  </span><br><span class="line">        <span class="keyword">then</span> return ()  </span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">do</span>  </span><br><span class="line">            putStrLn $ reverseWords line  </span><br><span class="line">            main  </span><br><span class="line">  </span><br><span class="line"><span class="title">reverseWords</span> :: <span class="type">String</span> -&gt; <span class="type">String</span>  </span><br><span class="line"><span class="title">reverseWords</span> = unwords . map reverse . words</span><br></pre></td></tr></table></figure>

<p><code>getArgs</code> <code>getProgName</code></p>
<p>putStr :: String -&gt; IO ()</p>
<p>putStrLn :: String -&gt; IO ()</p>
<p><a target="_blank" rel="noopener" href="http://cnhaskell.com/chp/7.html">haskell资料</a></p>
<p>以下是转换二进制pcd文件到ascii的例子</p>
<figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="title">test</span> :: <span class="type">IO</span>()</span><br><span class="line"><span class="title">test</span> = <span class="keyword">do</span></span><br><span class="line">    <span class="keyword">let</span> </span><br><span class="line">        pcd_get_header:: <span class="type">Handle</span>-&gt;<span class="type">IO</span> <span class="type">String</span></span><br><span class="line">        pcd_get_header h=my_recur h <span class="string">&quot; &quot;</span> <span class="number">11</span></span><br><span class="line">            <span class="keyword">where</span> </span><br><span class="line">                my_recur::<span class="type">Handle</span>-&gt;<span class="type">String</span>-&gt;<span class="type">Int</span> -&gt;<span class="type">IO</span> <span class="type">String</span></span><br><span class="line">                my_recur _ s <span class="number">0</span>= return s</span><br><span class="line">                my_recur h s n= <span class="keyword">do</span></span><br><span class="line">                    s1&lt;-bhGetLine h</span><br><span class="line">                    my_recur h (s++s1) (n<span class="number">-1</span>)</span><br><span class="line">        pcd_get_header_info::<span class="type">String</span>-&gt;(<span class="type">Int</span>,<span class="type">Int</span>)</span><br><span class="line">        pcd_get_header_info s=(a,b)</span><br><span class="line">            <span class="keyword">where</span></span><br><span class="line">                li=[str_get_words_index s i| i&lt;-[<span class="string">&quot;SIZE&quot;</span>,<span class="string">&quot;TYPE&quot;</span>,<span class="string">&quot;COUNT&quot;</span>,<span class="string">&quot;WIDTH&quot;</span>,<span class="string">&quot;POINTS&quot;</span>,<span class="string">&quot;DATA&quot;</span>]]</span><br><span class="line">                s1=[s !!i | i&lt;-[snd (li!!<span class="number">0</span>)+<span class="number">7.</span>.fst (li!!<span class="number">1</span>)<span class="number">-1</span>]]</span><br><span class="line">                s2=[s !!i | i&lt;-[snd (li!!<span class="number">2</span>)+<span class="number">7.</span>.fst (li!!<span class="number">3</span>)<span class="number">-1</span>]]</span><br><span class="line">                s3=[s !!i | i&lt;-[snd (li!!<span class="number">4</span>)+<span class="number">1.</span>.fst (li!!<span class="number">5</span>)<span class="number">-1</span>]]</span><br><span class="line">                b=read s3::<span class="type">Int</span></span><br><span class="line">                s11=fmap read $ words s1:: [<span class="type">Int</span>]</span><br><span class="line">                s22=fmap read $ words s2::[<span class="type">Int</span>] </span><br><span class="line">                a=sum $ zipWith (*) s11 s22</span><br><span class="line"></span><br><span class="line">        pcd_alter_header::<span class="type">String</span>-&gt;<span class="type">String</span></span><br><span class="line">        pcd_alter_header s=re</span><br><span class="line">            <span class="keyword">where</span></span><br><span class="line">                li=[str_get_words_index s i| i&lt;-[<span class="string">&quot;FIELDS&quot;</span>,<span class="string">&quot;SIZE&quot;</span>,<span class="string">&quot;TYPE&quot;</span>,<span class="string">&quot;COUNT&quot;</span>,<span class="string">&quot;WIDTH&quot;</span>,<span class="string">&quot;DATA&quot;</span>]]</span><br><span class="line">                li1=[snd (li!!<span class="number">0</span>)+<span class="number">7.</span>.fst (li!!<span class="number">1</span>)<span class="number">-2</span>]++[snd (li!!<span class="number">1</span>)+<span class="number">7.</span>.fst (li!!<span class="number">2</span>)<span class="number">-2</span>]++[snd (li!!<span class="number">2</span>)+<span class="number">7.</span>.fst (li!!<span class="number">3</span>)<span class="number">-2</span>]++[snd (li!!<span class="number">3</span>)+<span class="number">7.</span>.fst (li!!<span class="number">4</span>)<span class="number">-2</span>]++[snd (li!!<span class="number">5</span>)+<span class="number">1.</span>.length s<span class="number">-1</span>]</span><br><span class="line">                re=[s!!i | i&lt;-[<span class="number">0.</span>.length s <span class="number">-1</span>],not $ elem i li1] ++ <span class="string">&quot; ascii\n&quot;</span> </span><br><span class="line">        </span><br><span class="line">        pcd_fill_vector::<span class="type">Handle</span>-&gt;(<span class="type">Int</span>,<span class="type">Int</span>)-&gt;<span class="type">VM</span>.<span class="type">MVector</span> (<span class="type">PrimState</span> <span class="type">IO</span>) <span class="type">Float</span>-&gt;<span class="type">IO</span> (<span class="type">VM</span>.<span class="type">MVector</span> (<span class="type">PrimState</span> <span class="type">IO</span> ) <span class="type">Float</span>)</span><br><span class="line">        pcd_fill_vector h (sum,tsum) vec=my_recur h (sum,tsum) <span class="number">0</span> vec</span><br><span class="line">            <span class="keyword">where</span></span><br><span class="line">                my_recur::<span class="type">Handle</span>-&gt;(<span class="type">Int</span>,<span class="type">Int</span>)-&gt;<span class="type">Int</span>-&gt;<span class="type">VM</span>.<span class="type">MVector</span> (<span class="type">PrimState</span> <span class="type">IO</span>) <span class="type">Float</span>-&gt; <span class="type">IO</span> (<span class="type">VM</span>.<span class="type">MVector</span> (<span class="type">PrimState</span> <span class="type">IO</span>) <span class="type">Float</span>)</span><br><span class="line">                my_recur h1 (sum1,tsum1) n vec1 = </span><br><span class="line">                    <span class="keyword">if</span> n==tsum1 <span class="keyword">then</span></span><br><span class="line">                        return vec1</span><br><span class="line">                    <span class="keyword">else</span> <span class="keyword">do</span></span><br><span class="line">                        s&lt;-<span class="type">BL</span>.hGet h1 <span class="number">4</span></span><br><span class="line">                        <span class="type">VM</span>.write  vec1 (n*<span class="number">3</span>+<span class="number">0</span>) $ runGet getFloatle s</span><br><span class="line">                        s&lt;-<span class="type">BL</span>.hGet h1 <span class="number">4</span></span><br><span class="line">                        <span class="type">VM</span>.write  vec1 (n*<span class="number">3</span>+<span class="number">1</span>) $ runGet getFloatle s</span><br><span class="line">                        s&lt;-<span class="type">BL</span>.hGet h1 <span class="number">4</span></span><br><span class="line">                        <span class="type">VM</span>.write  vec1 (n*<span class="number">3</span>+<span class="number">2</span>) $ runGet getFloatle s</span><br><span class="line">                        s&lt;-<span class="type">BL</span>.hGet h1 sum1</span><br><span class="line">                        my_recur h1 (sum1,tsum1) (n+<span class="number">1</span>) vec1</span><br><span class="line">        pcd_write_file::<span class="type">V</span>.<span class="type">Vector</span> <span class="type">Float</span>-&gt;<span class="type">Handle</span>-&gt;<span class="type">Int</span>-&gt;<span class="type">IO</span>()</span><br><span class="line">        pcd_write_file vec h sum=my_recur vec h sum <span class="number">0</span></span><br><span class="line">            <span class="keyword">where</span></span><br><span class="line">                my_recur::<span class="type">V</span>.<span class="type">Vector</span> <span class="type">Float</span>-&gt;<span class="type">Handle</span>-&gt;<span class="type">Int</span>-&gt;<span class="type">Int</span>-&gt;<span class="type">IO</span>()</span><br><span class="line">                my_recur vec1 h1 sum1 n=</span><br><span class="line">                    <span class="keyword">if</span> n&gt;=sum1 <span class="keyword">then</span></span><br><span class="line">                        return ()</span><br><span class="line">                    <span class="keyword">else</span> <span class="keyword">do</span></span><br><span class="line">                        hPutStr h1 $ (show $vec1 <span class="type">V</span>.! (n*<span class="number">3</span>+<span class="number">0</span>))++<span class="string">&quot; &quot;</span> ++(show $ vec1 <span class="type">V</span>.! (n*<span class="number">3</span>+<span class="number">1</span>)) ++ <span class="string">&quot; &quot;</span> ++(show $ vec1 <span class="type">V</span>.! (n*<span class="number">3</span>+<span class="number">2</span>)) ++ <span class="string">&quot;\n&quot;</span></span><br><span class="line">                        my_recur  vec1 h1 sum1 (n+<span class="number">1</span>)   </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                    <span class="comment">---VM.write  vec1 (n*3+0) $ runGet getFloatle s</span></span><br><span class="line"></span><br><span class="line">    h1&lt;- openBinaryFile <span class="string">&quot;tree.pcd&quot;</span> <span class="type">ReadMode</span></span><br><span class="line">    h2&lt;- openFile <span class="string">&quot;tree1.pcd&quot;</span> <span class="type">WriteMode</span></span><br><span class="line">    s&lt;- pcd_get_header h1</span><br><span class="line"></span><br><span class="line">    (sum,tsum)&lt;-return $ pcd_get_header_info s </span><br><span class="line">    hPutStr h2 $ pcd_alter_header s</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    vec&lt;-<span class="type">VM</span>.new (tsum*<span class="number">3</span>)</span><br><span class="line">    pcd_fill_vector h1 (sum,tsum) vec</span><br><span class="line">    vec1&lt;-  <span class="type">V</span>.freeze vec</span><br><span class="line">    </span><br><span class="line">    pcd_write_file vec1 h2 tsum</span><br><span class="line">    <span class="comment">-- s&lt;-BL.hGet h1 4</span></span><br><span class="line">    <span class="comment">---putStrLn $show $runGet getFloatle s </span></span><br><span class="line">    <span class="comment">-- putStrLn$ BLC.unpack s</span></span><br><span class="line">    <span class="comment">-- putStrLn $ show  $ str_get_words_index &quot;fds ojibd\n dsoppqm\nlpps d&quot; &quot;dsoppqm&quot;</span></span><br><span class="line">    hClose h1</span><br><span class="line">    hClose h2</span><br><span class="line">    putStrLn <span class="string">&quot;end&quot;</span></span><br><span class="line">    return () </span><br></pre></td></tr></table></figure>

<p>在do模块中IO action是按顺序执行的s,</p>
<p>以下是一段神奇的代码</p>
<figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Control.Monad.ST</span><br><span class="line"><span class="keyword">import</span> Data.STRef</span><br><span class="line"><span class="keyword">import</span> Data.IORef</span><br><span class="line"></span><br><span class="line"><span class="title">counterIO</span> :: <span class="type">IO</span> (<span class="type">IO</span> <span class="type">Int</span>)</span><br><span class="line"><span class="title">counterIO</span> = <span class="keyword">do</span></span><br><span class="line">    c &lt;- newIORef <span class="number">0</span></span><br><span class="line">    return $ <span class="keyword">do</span></span><br><span class="line">        modifyIORef c (+<span class="number">1</span>)</span><br><span class="line">        readIORef c</span><br><span class="line"></span><br><span class="line"><span class="title">counterST</span> :: <span class="type">ST</span> s (<span class="type">ST</span> s <span class="type">Int</span>)</span><br><span class="line"><span class="title">counterST</span> = <span class="keyword">do</span></span><br><span class="line">    c &lt;- newSTRef <span class="number">0</span></span><br><span class="line">    return $ <span class="keyword">do</span></span><br><span class="line">        modifySTRef c (+<span class="number">1</span>)</span><br><span class="line">        readSTRef c</span><br><span class="line"></span><br><span class="line"><span class="title">main</span> = <span class="keyword">do</span></span><br><span class="line">    f &lt;- counterIO</span><br><span class="line">    print =&lt;&lt; f</span><br><span class="line">    print =&lt;&lt; f</span><br><span class="line">    print =&lt;&lt; f</span><br><span class="line">    print $ runST $ <span class="keyword">do</span></span><br><span class="line">        f2 &lt;- counterST</span><br><span class="line">        x &lt;- f2</span><br><span class="line">        y &lt;- f2</span><br><span class="line">        z &lt;- f2</span><br><span class="line">        return (x, y, z)</span><br></pre></td></tr></table></figure>



<h4 id="String-操作"><a href="#String-操作" class="headerlink" title="String 操作"></a>String 操作</h4><p>String 实际上是type String=[Char],所以String实际上是list,String用””括住，Char用’’括住。</p>
<table>
<thead>
<tr>
<th>算子</th>
<th>意义</th>
</tr>
</thead>
<tbody><tr>
<td>words::String-&gt; [String]</td>
<td>以空格和换行符\n分割字符串</td>
</tr>
<tr>
<td>lines:: String-&gt; [String]</td>
<td>以换行符分割字符串</td>
</tr>
<tr>
<td>peekCString</td>
<td></td>
</tr>
<tr>
<td>newCString</td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
</tbody></table>
<h4 id="其他一些"><a href="#其他一些" class="headerlink" title="其他一些"></a>其他一些</h4><p>.和$都是算子，.的算子运算级为9最高，$的运算级为0最低。两个算子都是中缀。</p>
<p> ($) :: (a -&gt; b) -&gt; a -&gt; b </p>
<p>(.) :: (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c</p>
<p>从效果上看，$用来加括号，.用来链接<code>b-&gt;c</code>类型的算子，</p>
<p>比如<code>unwords . map reverse .words</code>等价<code>unwords.(map reverse).words</code></p>
<p>但是如果这样调用函数<code>unwords . map reverse .words a</code>是错误的，因为它等价与</p>
<p>``unwords . (map reverse) .(words a)<code>,正确的调用应该是</code>(unwords . map reverse .words) a`</p>
<p>函数运算级<a target="_blank" rel="noopener" href="https://www.jianshu.com/p/10f0f509f2ea">这里</a>,<a target="_blank" rel="noopener" href="https://www.zhihu.com/question/353542558">这里</a></p>
<figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="title">a</span>=<span class="string">&quot;dsfd 798&quot;</span></span><br><span class="line"><span class="title">filter</span> (\te-&gt;(te&gt;=&#x27;<span class="number">0</span>&#x27;)&amp;&amp;(te&lt;=&#x27;<span class="number">9</span>&#x27;)) a</span><br></pre></td></tr></table></figure>

<p>有理数值</p>
<figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">:m <span class="type">Data</span>.<span class="type">Ratio</span></span><br><span class="line"><span class="number">12</span> % <span class="number">4</span></span><br></pre></td></tr></table></figure>

<p>算子内部定义算子可以与全局算子重名，且内部算子优先调用。</p>
<h4 id="Haskell-引用"><a href="#Haskell-引用" class="headerlink" title="Haskell 引用"></a>Haskell 引用</h4><p><a target="_blank" rel="noopener" href="http://hackage.haskell.org/package/base-4.14.0.0/docs/Foreign-StablePtr.html">这里</a></p>
<h4 id="FFI"><a href="#FFI" class="headerlink" title="FFI"></a>FFI</h4><figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="title">new</span> :: <span class="type">Storable</span> a =&gt; a-&gt;<span class="type">IO</span> (<span class="type">Ptr</span> a)</span><br><span class="line"><span class="comment">---用后记得free掉，如果不用的话</span></span><br><span class="line"><span class="title">free</span> :: <span class="type">Ptr</span> a -&gt; <span class="type">IO</span> ()</span><br><span class="line"><span class="title">newArray</span> :: <span class="type">Storable</span> a=&gt; [a] -&gt; <span class="type">IO</span> (<span class="type">Ptr</span> a)</span><br><span class="line"><span class="title">peekArray</span>:: <span class="type">Storable</span> a=&gt; <span class="type">Int</span> -&gt; <span class="type">Ptr</span> a-&gt; <span class="type">IO</span> [a]</span><br><span class="line"><span class="title">pokeArray</span>:: <span class="type">Storable</span> a=&gt; <span class="type">Ptr</span> a-&gt;[a]-&gt;<span class="type">IO</span> ()</span><br><span class="line"><span class="title">with</span> :: <span class="type">Storable</span> a=&gt; a -&gt;(<span class="type">Ptr</span> a-&gt; <span class="type">IO</span> b)-&gt;<span class="type">IO</span> b</span><br><span class="line"><span class="title">withArray</span> ::</span><br><span class="line"><span class="title">castPtr</span> :: <span class="type">Ptr</span> a-&gt;<span class="type">Ptr</span> b</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>各种数字类型转换主要是</p>
<figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="title">fromIntegral</span></span><br><span class="line"><span class="title">realToFrac</span></span><br><span class="line"><span class="title">newCString</span></span><br><span class="line"><span class="title">peekCString</span> ::<span class="type">CString</span> -&gt; <span class="type">IO</span> <span class="type">String</span></span><br><span class="line"><span class="keyword">foreign</span> <span class="keyword">import</span> <span class="keyword">ccall</span> <span class="string">&quot;&amp;exp&quot;</span> a_exp :: <span class="type">FunPtr</span> (<span class="type">Double</span>-&gt;<span class="type">Double</span>)</span><br><span class="line"><span class="keyword">foreign</span> <span class="keyword">import</span> <span class="keyword">ccall</span> <span class="string">&quot;dynamic&quot;</span> mkFun :: <span class="type">FunPtr</span> (<span class="type">Double</span>-&gt;<span class="type">Double</span>) -&gt; (<span class="type">Double</span> -&gt;<span class="type">Double</span>)</span><br><span class="line"><span class="keyword">foreign</span> <span class="keyword">import</span> <span class="keyword">ccall</span> <span class="string">&quot;wrapper&quot;</span> createFunptr :: (<span class="type">Double</span>-&gt;<span class="type">Double</span>) -&gt; <span class="type">FunPtr</span> (<span class="type">Double</span> -&gt;<span class="type">Double</span>)</span><br></pre></td></tr></table></figure>

<h4 id="一些库"><a href="#一些库" class="headerlink" title="一些库"></a>一些库</h4><table>
<thead>
<tr>
<th>库名</th>
<th>用途</th>
</tr>
</thead>
<tbody><tr>
<td>HMatrix</td>
<td>矩阵库</td>
</tr>
<tr>
<td>Text.Printf</td>
<td>格式化库</td>
</tr>
<tr>
<td>Text.Scanf</td>
<td>格式化库</td>
</tr>
<tr>
<td>HLearn</td>
<td>深度学习库</td>
</tr>
<tr>
<td>xformat</td>
<td>格式化库</td>
</tr>
<tr>
<td>HViewer</td>
<td>可视化库</td>
</tr>
<tr>
<td>HLibCell</td>
<td>高维网格库</td>
</tr>
<tr>
<td>HDBC</td>
<td>数据库</td>
</tr>
<tr>
<td>hip</td>
<td>图像处理库</td>
</tr>
<tr>
<td>IHP</td>
<td>web框架</td>
</tr>
<tr>
<td>postgresql-simple</td>
<td>数据库(IHP库使用的数据库)</td>
</tr>
<tr>
<td>stm</td>
<td>线程并发库</td>
</tr>
<tr>
<td>ffmpeg-light</td>
<td>ffmpeg的绑定库</td>
</tr>
<tr>
<td>JuicyPixels</td>
<td>图像库</td>
</tr>
<tr>
<td>accelarate</td>
<td>GPU并行库</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
</tbody></table>
<p><a target="_blank" rel="noopener" href="https://ihp.digitallyinduced.com/Guide/index.html">IHP</a></p>
<h4 id="Haskell的类型系统"><a href="#Haskell的类型系统" class="headerlink" title="Haskell的类型系统"></a>Haskell的类型系统</h4><figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">data</span> <span class="type">Node</span> a=<span class="type">Cons</span> a (<span class="type">Node</span> <span class="title">a</span>)|<span class="type">NULL</span></span></span><br></pre></td></tr></table></figure>

<p>上面共声明了这几种类型<code>Node a</code> <code>Node Int</code>…..<code>Node String</code>…</p>
<p>其中NULL属于<code>Node a</code> <code>Node Int</code> …所有类型，</p>
<p>haskell的类型系统非常”工程”。</p>
<p><a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/60650929/cabal-cannot-find-locally-sourced-yet-correctly-installed-packages">haskell配置问题</a></p>
<p>原生hasklel(没有语言扩展)，typeclass只支持一个type variable parameters,</p>
<p>每个typeclass的instance的type variable必须写成(Node a)或者(Maybe a),不允许写成(Node Int)等。</p>
<p>经常用到的两个扩展是MultiParamTypeClasses <a href="%E5%85%81%E8%AE%B8class%E6%8E%A5%E5%8F%97%E5%A4%9A%E4%B8%AAtypevariable%E3%80%82">^1</a> ,FlexibleInstances[^2] .</p>
<p>[^2]: 允许instance的 type类型为(Node Int)</p>
<h4 id="haskell-vector"><a href="#haskell-vector" class="headerlink" title="haskell vector"></a>haskell vector</h4><p>Data.Vector</p>
<table>
<thead>
<tr>
<th>算子</th>
<th>意义</th>
</tr>
</thead>
<tbody><tr>
<td>length</td>
<td>返回vector长度</td>
</tr>
<tr>
<td>null</td>
<td>vector是否空</td>
</tr>
<tr>
<td>!</td>
<td>返回索引所在的值</td>
</tr>
<tr>
<td>!?</td>
<td>返回索引所在的值，被Maybe包裹</td>
</tr>
<tr>
<td>head</td>
<td>返回第一个元素</td>
</tr>
<tr>
<td>last</td>
<td>返回最后一个元素</td>
</tr>
<tr>
<td>empty</td>
<td>是否为空</td>
</tr>
<tr>
<td>generate</td>
<td>vector的生成(generate 10 (\n -&gt; Data.Vector.replicate 10 n))</td>
</tr>
<tr>
<td>init</td>
<td>返回除去最后一个元素的vector</td>
</tr>
<tr>
<td>tail</td>
<td>返回出去第一个元素的vector</td>
</tr>
<tr>
<td>take</td>
<td>返回前n个元素的vector</td>
</tr>
<tr>
<td>drop</td>
<td>去掉前n个元素的vector</td>
</tr>
<tr>
<td>//</td>
<td>批量修改，</td>
</tr>
<tr>
<td>zipWith</td>
<td>和list一样</td>
</tr>
<tr>
<td>foldr</td>
<td>和list一样</td>
</tr>
<tr>
<td>freeze</td>
<td>将mutable vector转化为vector</td>
</tr>
<tr>
<td>copy</td>
<td>将vector 的内容复制到mutable vector</td>
</tr>
<tr>
<td>create</td>
<td>create (do { v &lt;- new 2; write v 0 ‘a’; write v 1 ‘b’; return v }) = &lt;a,b&gt;</td>
</tr>
</tbody></table>
<p>Data.Vector.Mutable</p>
<table>
<thead>
<tr>
<th>算子</th>
<th>意义</th>
</tr>
</thead>
<tbody><tr>
<td>length</td>
<td></td>
</tr>
<tr>
<td>null</td>
<td></td>
</tr>
<tr>
<td>slice</td>
<td></td>
</tr>
<tr>
<td>init</td>
<td></td>
</tr>
<tr>
<td>tail</td>
<td></td>
</tr>
<tr>
<td>take</td>
<td></td>
</tr>
<tr>
<td>drop</td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
</tbody></table>
<figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span>           Control.Monad.ST</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">qualified</span> Data.Vector <span class="keyword">as</span> V</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">qualified</span> Data.Vector.Mutable <span class="keyword">as</span> MV</span><br><span class="line"><span class="title">main</span> :: <span class="type">IO</span> ()</span><br><span class="line"><span class="title">main</span> = <span class="keyword">do</span></span><br><span class="line">  <span class="comment">-- Using the IO monad:</span></span><br><span class="line">  vec &lt;-</span><br><span class="line">    <span class="keyword">do</span> v &lt;- <span class="type">MV</span>.new <span class="number">1</span></span><br><span class="line">       <span class="type">MV</span>.write v <span class="number">0</span> (<span class="number">1</span> :: <span class="type">Int</span>)</span><br><span class="line">       <span class="type">V</span>.freeze v</span><br><span class="line">  print vec</span><br><span class="line">  <span class="comment">-- Using the ST monad:</span></span><br><span class="line">  print</span><br><span class="line">    (runST</span><br><span class="line">       (<span class="keyword">do</span> v &lt;- <span class="type">MV</span>.new <span class="number">1</span></span><br><span class="line">           <span class="type">MV</span>.write v <span class="number">0</span> (<span class="number">1</span> :: <span class="type">Int</span>)</span><br><span class="line">           <span class="type">V</span>.freeze v))</span><br></pre></td></tr></table></figure>

<figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Control.Monad.ST</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">qualified</span> Data.Vector.Mutable <span class="keyword">as</span> VM</span><br><span class="line"></span><br><span class="line"><span class="comment">-- This returns a reference to a vector, wrapped in the ST s monad.</span></span><br><span class="line"><span class="title">test</span> :: <span class="type">ST</span> s (<span class="type">VM</span>.<span class="type">MVector</span> s <span class="type">Int</span>)</span><br><span class="line"><span class="title">test</span> = <span class="keyword">do</span></span><br><span class="line">  v &lt;- <span class="type">VM</span>.new <span class="number">10</span>       <span class="comment">-- create vector</span></span><br><span class="line">  <span class="type">VM</span>.write v <span class="number">3</span> <span class="number">2000</span>    <span class="comment">-- modify it</span></span><br><span class="line">  <span class="type">VM</span>.write v <span class="number">4</span> <span class="number">3000</span></span><br><span class="line">  x &lt;- <span class="type">VM</span>.read v <span class="number">3</span>     <span class="comment">-- access it</span></span><br><span class="line">  <span class="type">VM</span>.write v <span class="number">4</span> (x+<span class="number">1</span>)   </span><br><span class="line">  return v             <span class="comment">-- return it</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- This instead returns a (wrapped) Int</span></span><br><span class="line"><span class="title">test2</span> :: <span class="type">ST</span> s <span class="type">Int</span></span><br><span class="line"><span class="title">test2</span> = <span class="keyword">do</span></span><br><span class="line">  v &lt;- test            <span class="comment">-- call test, which performs the allocation</span></span><br><span class="line">  <span class="type">VM</span>.read v <span class="number">4</span>          <span class="comment">-- return v[4]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- This returns a plain pure Int value    </span></span><br><span class="line"><span class="title">test3</span> :: <span class="type">Int</span></span><br><span class="line"><span class="title">test3</span> = runST test2</span><br></pre></td></tr></table></figure>





<h4 id="Module"><a href="#Module" class="headerlink" title="Module"></a>Module</h4><p>模块的名字不需要与文件名相同，模块不需要在一个文件中，可以在多个文件中,一个文件也可以写多个模块。模块名也可以和模块内的函数，data types相同。在模块名后面加括号，里面表示对外可见或者将要导入的内容</p>
<p>,如</p>
<figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> Test (<span class="title">tree</span> ,<span class="title">f</span>,<span class="title">myrecur</span>) <span class="keyword">where</span></span><br></pre></td></tr></table></figure>

<p>表示此模块的tree,f,myrecur对外可见，</p>
<figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Test(<span class="title">f</span>) </span><br></pre></td></tr></table></figure>

<p>表示导入Test模块的f.</p>
<p>如果不写括号，则表示多有内容对外可见或者所有可见内容将被导入。</p>
<p>默认情况下，模块A中被导入的模块B，在导入模块A时B并不会被导入。如果要实现导入模块A时，模块B也会被导入，可以如下写模块A:</p>
<figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> A (<span class="title">module</span> <span class="type">A</span>,<span class="title">module</span> <span class="type">B</span>) hiding somefun <span class="keyword">where</span></span><br></pre></td></tr></table></figure>

<h4 id="Haskell-并发"><a href="#Haskell-并发" class="headerlink" title="Haskell 并发"></a>Haskell 并发</h4><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/zwvista/p/9339587.html">haskell 并发</a></p>

      
    </div><!-- .entry-content -->

    <footer class="entry-meta">
    <a href="/2020/07/15/haskell%E5%AE%9E%E6%88%98%E5%92%8C%E4%BE%8B%E5%AD%90/">
    <time datetime="2020-07-15T00:37:24.000Z" class="entry-date">
        2020-07-15
    </time>
</a>
    
  <span class="article-delim">&#8226;</span>
  <div class="article-category">
  <a class="article-category-link" href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">学习笔记</a>
  </div>

    
  <span class="article-delim">&#8226;</span>
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%95%B0%E5%AD%A6/" rel="tag">数学</a></li></ul>

    </footer>
</article>


    
<nav class="nav-single">
    <h3 class="assistive-text">文章导航</h3>
    
        <span class="nav-previous"><a href="/2021/07/01/rust%E7%AC%94%E8%AE%B0/" rel="prev"><span class="meta-nav">←</span> rust笔记</a></span>
    
    
        <span class="nav-next"><a href="/2020/07/03/%E9%BB%8E%E6%9B%BC%E6%9B%B2%E9%9D%A2%E7%AC%94%E8%AE%B0/" rel="next">黎曼曲面笔记 <span class="meta-nav">→</span></a></span>
    
</nav><!-- .nav-single -->






<section id="comments">
  <!-- 多说评论框 start -->
  <div id="gitalk-container" style="margin: 30px;"></div>
    <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
    <script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
    <script>
        var gitalk = new Gitalk({
            clientID: '3227fda9287cfd4d5cab',
            clientSecret: '9ba26389f1bb6e896001f95b0c0482df62f2b9f6',
            repo: 'wujilingfeng.github.io',
            owner: 'wujilingfeng',
            id: 'haskell实战和例子',
            admin: 'wujilingfeng'
        })
 
        gitalk.render('gitalk-container')
    </script>
  <!-- 多说公共JS代码 end -->
</section>



</div></div>
        <div id="secondary" class="widget-area" role="complementary">
  
    <aside id="search" class="widget widget_search"><form role="search" method="get" accept-charset="utf-8" id="searchform" class="searchform" action="//google.com/search">
    <div>
        <input type="text" value="" name="s" id="s" />
        <input type="submit" id="searchsubmit" value="搜索" />
    </div>
</form></aside>
  
    
  <aside class="widget">
    <h3 class="widget-title">Music</h3>
    <div class="widget-content">
      <audio src="/music.mp3" controls="controls" loop="loop" autoplay=true
             style="width:100%">
        您的浏览器不支持 audio 标签。
      </audio>
    </div>
  </aside>


  
    
  <aside class="widget">
    <h3 class="widget-title">Categories</h3>
    <div class="widget-content">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">学习笔记</a><span class="category-list-count">29</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%95%B0%E5%AD%A6/">数学</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%94%9F%E6%B4%BB/">生活</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%AE%97%E6%B3%95/">算法</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA/">计算机</a><span class="category-list-count">5</span></li></ul>
    </div>
  </aside>

  
    
  <aside class="widget">
    <h3 class="widget-title">Recents</h3>
    <div class="widget-content">
      <ul>
        
          <li>
            <a href="/2021/07/01/rust%E7%AC%94%E8%AE%B0/">rust笔记</a>
          </li>
        
          <li>
            <a href="/2020/07/15/haskell%E5%AE%9E%E6%88%98%E5%92%8C%E4%BE%8B%E5%AD%90/">haskell实战和例子</a>
          </li>
        
          <li>
            <a href="/2020/07/03/%E9%BB%8E%E6%9B%BC%E6%9B%B2%E9%9D%A2%E7%AC%94%E8%AE%B0/">黎曼曲面笔记</a>
          </li>
        
          <li>
            <a href="/2020/05/12/haskell/">haskell</a>
          </li>
        
          <li>
            <a href="/2020/02/13/%E5%81%8F%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B%E7%AC%94%E8%AE%B0-PDE/">偏微分方程笔记(PDE)</a>
          </li>
        
      </ul>
    </div>
  </aside>

  
    
  <aside class="widget">
    <h3 class="widget-title">Tags</h3>
    <div class="widget-content">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/linux/" rel="tag">linux</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%BB%A3%E7%A0%81/" rel="tag">代码</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%8D%9A%E5%AE%A2/" rel="tag">博客</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%B7%A5%E5%85%B7/" rel="tag">工具</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%95%B0%E5%AD%A6/" rel="tag">数学</a><span class="tag-list-count">26</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%95%B0%E5%AD%A6%EF%BC%8C%E8%AE%A1%E7%AE%97%E6%9C%BA/" rel="tag">数学，计算机</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%B2%B3%E5%8D%97/" rel="tag">河南</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%AE%97%E6%B3%95/" rel="tag">算法</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%BC%96%E7%A8%8B/" rel="tag">编程</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%BD%91%E7%BB%9C/" rel="tag">网络</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA/" rel="tag">计算机</a><span class="tag-list-count">4</span></li></ul>
    </div>
  </aside>

  
    
  <aside class="widget">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget-content tagcloud">
      <a href="/tags/linux/" style="font-size: 12.5px;">linux</a> <a href="/tags/%E4%BB%A3%E7%A0%81/" style="font-size: 10px;">代码</a> <a href="/tags/%E5%8D%9A%E5%AE%A2/" style="font-size: 15px;">博客</a> <a href="/tags/%E5%B7%A5%E5%85%B7/" style="font-size: 17.5px;">工具</a> <a href="/tags/%E6%95%B0%E5%AD%A6/" style="font-size: 20px;">数学</a> <a href="/tags/%E6%95%B0%E5%AD%A6%EF%BC%8C%E8%AE%A1%E7%AE%97%E6%9C%BA/" style="font-size: 10px;">数学，计算机</a> <a href="/tags/%E6%B2%B3%E5%8D%97/" style="font-size: 12.5px;">河南</a> <a href="/tags/%E7%AE%97%E6%B3%95/" style="font-size: 12.5px;">算法</a> <a href="/tags/%E7%BC%96%E7%A8%8B/" style="font-size: 10px;">编程</a> <a href="/tags/%E7%BD%91%E7%BB%9C/" style="font-size: 10px;">网络</a> <a href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA/" style="font-size: 17.5px;">计算机</a>
    </div>
  </aside>

  
</div>
      </div>
      <footer id="colophon" role="contentinfo">
    <p>&copy; 2022 李博
    All rights reserved.</p>
    <p>Powered by <a href="http://hexo.io/" target="_blank">Hexo</a></p>
</footer>
    <script>window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"1","bdMiniList":false,"bdPic":"","bdStyle":"2","bdSize":"16"},"share":{}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='/js/share.js'];</script>

<script src="/js/jquery-3.3.1.min.js"></script>


  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/script.js"></script>


<script src="/js/navigation.js"></script>

<div id="bg"></div>

  </div>
</body>
</html>